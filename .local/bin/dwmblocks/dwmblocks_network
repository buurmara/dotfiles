#!/bin/sh

CONNAME=$(nmcli -a | grep 'Wired connection' | awk 'NR==1{print $1}')
[ "$CONNAME" = '' ] && CONNAME=$(nmcli -t -f active,ssid dev wifi | grep '^yes' | cut -c 5-)

PRIVATE=$(nmcli -a | grep 'inet4 192' | awk '{print $2}')
PUBLIC=$(curl -s https://ipinfo.io/ip)

if [ "$CONNAME" = '' ]; then
  printf ' ^c#F1EBEB^NET ^c#EEB422^Not connected '
else
  if [ "$PUBLIC" = '' ]; then
    printf ' ^c#F1EBEB^NET ^c#EEB422^%s: %s - %s ' "$CONNAME" "$PRIVATE" 'No public IP detected'
  else
    printf ' ^c#F1EBEB^NET ^c#EEB422^%s: %s - %s ' "$CONNAME" "$PRIVATE" "$PUBLIC"
  fi
fi
